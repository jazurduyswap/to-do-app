{% extends 'base.html.twig' %}

{% block title %}Crear Nueva Tarea{% endblock %}

{% block body %}
<div class="container mt-5">
        <h1 class="mb-4">Crear Nueva Tarea</h1>
        <div class="card shadow-sm">
            <div class="card-body">
                {{ form_start(form) }}
                <div class="mb-3">
                    {{ form_label(form.titulo, null) }}
                    {{ form_widget(form.titulo, {'attr': {'class': 'form-control'}}) }}
                    {{ form_errors(form.titulo) }}
                </div>
                <div class="mb-3">
                    {{ form_label(form.parentTask, null, {label: 'Tarea Padre'}) }}
                    {{ form_widget(form.parentTask, {'attr': {'class': 'form-select'}}) }}
                    {{ form_errors(form.parentTask) }}
                </div>
                <div class="mb-4">
                    <h5 class="mb-2">Subtareas</h5>
                    <div data-controller="collection">
                        <div data-collection-target="container"
                                 data-prototype="{{ form_widget(form.childTasks.vars.prototype)|e('html_attr') }}">
                            {{ form_widget(form.childTasks) }}
                        </div>
                        <button type="button" class="btn btn-outline-success mt-2" data-action="collection#add" data-collection-target="addButton">
                            <i class="bi bi-plus-circle"></i> Añadir Subtarea
                        </button>
                    </div>
                </div>
                <div class="mb-4">
                    <h5 class="mb-2">Tags nuevos</h5>
                    <div data-controller="collection">
                        <div data-collection-target="container"
                                 data-prototype="{{ form_widget(form.tags.vars.prototype)|e('html_attr') }}">
                            {{ form_widget(form.tags) }}
                        </div>
                        <button type="button" class="btn btn-outline-success mt-2" data-action="collection#add" data-collection-target="addButton">
                            <i class="bi bi-plus-circle"></i> Añadir Tag
                        </button>
                    </div>
                </div>
                <div class="mb-4">
                    <h5 class="mb-3">Seleccionar tags existentes</h5>
                    <div class="row">
                        {% for choice in form.tagsExistentes %}
                            <div class="col-md-4 mb-2">
                                <div class="form-check">
                                    {{ form_widget(choice, {'attr': {'class': 'form-check-input'}}) }}
                                    {{ form_label(choice, null, {'label_attr': {'class': 'form-check-label'}}) }}
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    {{ form_errors(form.tagsExistentes) }}
                    <small class="form-text text-muted">Selecciona los tags existentes que quieres asociar a esta tarea.</small>
                </div>
                <div class="d-grid">
                    <button type="submit" class="btn btn-primary btn-lg">Crear Tarea</button>
                </div>
            </div>
        </div>
</div>
{% endblock %}